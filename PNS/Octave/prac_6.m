clc;
clear all;
close all;

# X->X  Y->Y

X = [87.5 50 75 62.5 100 87.5 87.5 87.5 87.5 75 50 75 62.5 87.5 87.5 87.5 75 37.5 14.289999999999999 100 57.140000000000001 14.289999999999999 57.140000000000001 71.430000000000007 85.709999999999994 85.709999999999994 85.709999999999994 71.430000000000007 85.709999999999994 28.57 71.430000000000007 57.140000000000001 85.709999999999994 28.57 71.430000000000007 28.57 33.329999999999998 66.670000000000002 83.329999999999998 83.329999999999998 66.670000000000002 50 50 83.329999999999998 83.329999999999998 83.329999999999998 83.329999999999998 100 66.670000000000002 66.670000000000002 83.329999999999998 83.329999999999998 66.670000000000002 100 50 70 70 80 100 100 70 80 100 100 90 80 50 80 90 60 80 60 60 100 83.329999999999998 100 83.329999999999998 50 100 50 83.329999999999998 83.329999999999998 83.329999999999998 66.670000000000002 50 66.670000000000002 66.670000000000002 100 83.329999999999998 83.329999999999998 83.329999999999998 37.5 87.5 62.5 75 50 75 25 100 37.5 50 87.5 75 0 75 50 62.5 12.5];
Y = [86.959999999999994 43.479999999999997 73.909999999999997 69.569999999999993 91.299999999999997 60.869999999999997 78.260000000000005 82.609999999999999 82.609999999999999 65.219999999999999 39.130000000000003 56.520000000000003 73.909999999999997 86.959999999999994 78.260000000000005 56.520000000000003 65.219999999999999 34.780000000000001 43.479999999999997 86.959999999999994 73.909999999999997 30.43 73.909999999999997 73.909999999999997 95.650000000000006 95.650000000000006 82.609999999999999 78.260000000000005 73.909999999999997 60.869999999999997 73.909999999999997 73.909999999999997 91.299999999999997 52.170000000000002 82.609999999999999 43.479999999999997 56.520000000000003 69.569999999999993 56.520000000000003 78.260000000000005 73.909999999999997 47.829999999999998 60.869999999999997 82.609999999999999 73.909999999999997 82.609999999999999 82.609999999999999 86.959999999999994 69.569999999999993 52.170000000000002 86.959999999999994 91.299999999999997 47.829999999999998 65.219999999999999 60 60 85 85 85 100 65 65 90 90 90 90 85 80 95 60 80 75 60 95 95 90 75 55 80 45 90 90 85 60 75 50 60 90 90 90 85 50 85 35 100 65 60 40 100 65 90 75 65 25 85 40 45 45];


#E(X) E(Y)
E_X = sum(X)/length(X)
E_Y = sum(Y)/length(Y)

#V(X) V(Y)
E_Xsqr = (sum(X.^2)/length(X))
E_Ysqr = (sum(Y.^2)/length(Y))
V_X = E_Xsqr - (E_X^2)
V_Y = E_Ysqr - (E_Y^2)

# E(XY)
XY = X.*Y;
E_XY = sum(XY)/length(XY)

cov = E_XY - (E_X * E_Y)

#byx = cov/x, bxy = cov/y
byx = cov/V_X
bxy = cov/V_Y
r = sqrt(byx*bxy)

#x -x' = bxy(y-y')            y-y' = byx(x-x')
#x = bxy*y - bxy*y' + x'      y = byx*x - byx*x' + y'
printf("\nRegression Equation of X on Y: x = %dy + (%d)\n", bxy, (-bxy*E_Y + E_X))
printf("\nRegression Equation of Y on X: y = %dx + (%d)\n", byx, (-byx*E_X + E_Y))

X_in = input("\nEnter x: ");
Y_est = byx*X_in - byx*E_X + E_Y
Y_in = input("\nEnter y: ");
X_est = bxy*Y_in - bxy*E_Y + E_X

# Generating points for regression line
X_data = linspace(min(X),max(X),1616);
Y_line =  byx*X_data - byx*E_X + E_Y;

plot(X_data,Y_line,'Color','#b75969','b.', 'Markersize', 5) # Regression line Y on X
hold on;

Y_data = linspace(min(Y),max(Y),1616);
X_line = bxy*Y_data - bxy*E_Y + E_X;

plot(Y_data,X_line,'Color','#5e81cc','b.', 'Markersize', 5) # Regression line X on Y
plot(X,Y,'b.', 'Markersize', 12, 'Color', '#2aa1b3')
